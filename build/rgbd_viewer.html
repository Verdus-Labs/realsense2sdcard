<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RealSense RGB-D Data Viewer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        
        .frame-display {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .frame-panel {
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #fafafa;
        }
        
        .frame-panel h3 {
            margin: 0 0 15px 0;
            color: #333;
        }
        
        .frame-panel img {
            max-width: 500px;
            max-height: 400px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        input[type="range"] {
            width: 300px;
        }
        
        .frame-info {
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }
        
        .status {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
        }
        
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
        }
        
        .success {
            color: #155724;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ RealSense RGB-D Data Viewer</h1>
            <p>Simple frame-by-frame viewer</p>
        </div>
        
        <div id="loadStatus" class="status success">
            ‚úÖ Ready to view frames
        </div>
        
        <div id="viewerSection">
            <div class="controls">
                <button id="prevBtn" onclick="previousFrame()">‚¨ÖÔ∏è Previous</button>
                <span id="frameInfo">Frame 1 of 19</span>
                <button id="nextBtn" onclick="nextFrame()">‚û°Ô∏è Next</button>
                <button onclick="playSlideshow()">‚ñ∂Ô∏è Play</button>
                <button onclick="stopSlideshow()">‚è∏Ô∏è Stop</button>
            </div>
            
            <div class="controls">
                <input type="range" id="frameSlider" min="1" max="19" value="1" onchange="goToFrame(this.value)">
            </div>
            
            <div class="frame-display">
                <div class="frame-panel">
                    <h3>üé® RGB Image</h3>
                    <img id="rgbImage" src="" alt="RGB frame" onerror="handleImageError(this, 'RGB')">
                    <div id="rgbInfo">Loading...</div>
                </div>
                
                <div class="frame-panel">
                    <h3>üìè Depth Image</h3>
                    <img id="depthImage" src="" alt="Depth frame" onerror="handleImageError(this, 'Depth')">
                    <div id="depthInfo">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentFrame = 1;
        let slideshowInterval = null;
        const maxFrames = 19; // Adjust this based on your actual frame count
        
        // Frame data based on your actual files
        const frameData = [
            { frameNum: "000001", timestamp: "1749676928282" },
            { frameNum: "000002", timestamp: "1749676928862" },
            { frameNum: "000003", timestamp: "1749676929381" },
            { frameNum: "000004", timestamp: "1749676929904" },
            { frameNum: "000005", timestamp: "1749676930433" },
            { frameNum: "000006", timestamp: "1749676930968" },
            { frameNum: "000007", timestamp: "1749676931494" },
            { frameNum: "000008", timestamp: "1749676932017" },
            { frameNum: "000009", timestamp: "1749676932530" },
            { frameNum: "000010", timestamp: "1749676933043" },
            { frameNum: "000011", timestamp: "1749676933562" },
            { frameNum: "000012", timestamp: "1749676934079" },
            { frameNum: "000013", timestamp: "1749676934602" },
            { frameNum: "000014", timestamp: "1749676935126" },
            { frameNum: "000015", timestamp: "1749676935658" },
            { frameNum: "000016", timestamp: "1749676936193" },
            { frameNum: "000017", timestamp: "1749676936716" },
            { frameNum: "000018", timestamp: "1749676937249" },
            { frameNum: "000019", timestamp: "1749676937771" }
        ];
        
        // Start viewing when page loads
        window.addEventListener('load', () => {
            showFrame(1);
        });
        
        function showFrame(frameNumber) {
            if (frameNumber < 1 || frameNumber > maxFrames) return;
            
            currentFrame = frameNumber;
            const frame = frameData[frameNumber - 1];
            
            // Build file paths
            const rgbPath = `captured_data/rgb/frame_${frame.frameNum}_${frame.timestamp}_color.png`;
            const depthPath = `captured_data/depth/frame_${frame.frameNum}_${frame.timestamp}_depth.png`;
            const depthColorizedPath = `captured_data/depth/frame_${frame.frameNum}_${frame.timestamp}_depth_colorized.png`;
            
            // Update images
            document.getElementById('rgbImage').src = rgbPath;
            document.getElementById('depthImage').src = depthColorizedPath; // Try colorized first
            
            // Update info
            document.getElementById('frameInfo').textContent = `Frame ${frameNumber} of ${maxFrames}`;
            document.getElementById('rgbInfo').textContent = 'Loading RGB...';
            document.getElementById('depthInfo').textContent = 'Loading Depth...';
            
            // Update slider
            document.getElementById('frameSlider').value = frameNumber;
            
            updateControls();
        }
        
        function handleImageError(img, type) {
            if (type === 'Depth' && img.src.includes('colorized')) {
                // If colorized depth fails, try raw depth
                const currentSrc = img.src;
                const rawDepthSrc = currentSrc.replace('_depth_colorized.png', '_depth.png');
                if (currentSrc !== rawDepthSrc) {
                    img.src = rawDepthSrc;
                    return;
                }
            }
            
            img.style.display = 'none';
            const infoElement = document.getElementById(type.toLowerCase() + 'Info');
            infoElement.textContent = `‚ùå ${type} not available`;
        }
        
        // When images load successfully
        document.getElementById('rgbImage').onload = function() {
            this.style.display = 'block';
            document.getElementById('rgbInfo').textContent = '‚úÖ RGB loaded';
        };
        
        document.getElementById('depthImage').onload = function() {
            this.style.display = 'block';
            const isColorized = this.src.includes('colorized');
            document.getElementById('depthInfo').textContent = `‚úÖ ${isColorized ? 'Colorized ' : ''}Depth loaded`;
        };
        
        function updateControls() {
            document.getElementById('prevBtn').disabled = currentFrame === 1;
            document.getElementById('nextBtn').disabled = currentFrame === maxFrames;
        }
        
        function previousFrame() {
            if (currentFrame > 1) {
                showFrame(currentFrame - 1);
            }
        }
        
        function nextFrame() {
            if (currentFrame < maxFrames) {
                showFrame(currentFrame + 1);
            }
        }
        
        function goToFrame(frameNumber) {
            showFrame(parseInt(frameNumber));
        }
        
        function playSlideshow() {
            if (slideshowInterval) return;
            
            slideshowInterval = setInterval(() => {
                if (currentFrame < maxFrames) {
                    nextFrame();
                } else {
                    stopSlideshow();
                }
            }, 500); // 2fps playback
        }
        
        function stopSlideshow() {
            if (slideshowInterval) {
                clearInterval(slideshowInterval);
                slideshowInterval = null;
            }
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowLeft':
                    previousFrame();
                    break;
                case 'ArrowRight':
                    nextFrame();
                    break;
                case ' ':
                    e.preventDefault();
                    if (slideshowInterval) {
                        stopSlideshow();
                    } else {
                        playSlideshow();
                    }
                    break;
            }
        });
    </script>
</body>
</html>